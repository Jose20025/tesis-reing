@startuml er-as-is
' ============================================================
'        DIAGRAMA ER DEL SISTEMA AS-IS (VISUAL FOXPRO)
' ============================================================

entity almhead {
  *tipotrans : string
  *numtrans : int
  fecha : date
  vence : date
  codcli : string
  codprov : string
  codprom : string
  total : float
  dcto : float
  neto : float
}

entity almtrans {
  *tipotrans : string
  *numtrans : int
  codalm : string
  fecha : date
  codmat : string
  cantidad : float
  punit : float
  pcosto : float
  nrolote : string
}

entity cliente {
  *codcli : string
  nombre : string
  direccion : string
  telefono : string
  zona : string
  deuda : float
  tipocliente : string
}

entity pago {
  *tipotrans : string
  *numtrans : int
  fecha : date
  importe : float
  observ : string
  codbanco : string
  recibo : string
  estado : string
}

entity almmat {
  *codmat : string
  descripcion : string
  grupo : string
  marca : string
  pcompra : float
  pventa : float
  stockmin : float
  activo : bool
}

entity almacen {
  *codalm : string
  descripcion : string
}

entity grupo {
  *codgrupo : string
  descripcion : string
}

entity marca {
  *codmarca : string
  descripcion : string
}

entity lotemaster {
  *codmat : string
  *lote : string
  cantidad : int
  fingreso : date
  mesvenc : int
  anovenc : int
  activo : bool
}

entity banco {
  *codigo : string
  detalle : string
  moneda : string
  saldo : float
}

entity zona {
  *codigo : string
  nombre : string
  ciudad : string
  tipo : string
  padre : string
}

' ============================================================
'              ENTIDADES INVENTADAS (AS-IS EXTENDIDO)
' ============================================================

entity pedhead {
  *numped : string
  fecreg : date
  codcli : string
  codprom : string
  estado : string
  total : float
  obs : string
}

entity peddet {
  *numped : string
  *item : int
  codmat : string
  cantidad : float
  punit : float
  subtotal : float
}

entity gastocab {
  *numgasto : string
  fecreg : date
  codprom : string
  tipog : string
  glosa : string
  total : float
}

entity gastodet {
  *numgasto : string
  *item : int
  codcta : string
  descri : string
  monto : float
}

' ============================================================
'                     RELACIONES PRINCIPALES
' ============================================================

almhead ||--o{ almtrans : "detalle"
cliente ||--o{ almhead : "realiza"
almhead ||--o{ pago : "pagos"
almmat ||--o{ almtrans : "producto"
almacen ||--o{ almtrans : "almac√©n"
grupo ||--o{ almmat : "grupo"
marca ||--o{ almmat : "marca"
almmat ||--o{ lotemaster : "lotes"
banco ||--o{ pago : "banco"
zona ||--o{ cliente : "zona"

' ============================================================
'                RELACIONES DE PEDIDOS (AS-IS)
' ============================================================

cliente ||--o{ pedhead : "solicita"
pedhead ||--o{ peddet : "detalle"
almmat ||--o{ peddet : "producto"

' ============================================================
'                RELACIONES DE GASTOS (AS-IS)
' ============================================================

gastocab ||--o{ gastodet : "detalle"
cliente ||--o{ gastocab : "registrado a"
gastocab }o--|| pedhead : "asociado a pedido?"

@enduml
